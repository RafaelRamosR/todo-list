"use strict";var form=document.getElementById("form"),divTask=document.querySelector(".viewTask"),fragment=document.createDocumentFragment();form.addEventListener("submit",(function(e){e.preventDefault();var t=e.target,a=t.typeTask.value,n=t.radioColor.value,r=t.inputDate.value,i=t.inputTime.value,o=r+" "+i,l=btoa(o+Math.random());if(!validateEmpty(a))return validationMessage("Debe especificar el nombre de la tarea.");if(!validateEmpty(n))return validationMessage("Seleccione un color antes de enviar");if(!validateDate(r,i))return validationMessage("La fecha es invalida, ingrese una fecha superior a la fecha y hora actual.");var s={id:l,task:a,color:n,date:o};form.reset(),setStorage(s.id,JSON.stringify(s)),getStorage(s.id),cleanMessage()}));var countDownDate=function(e){var t=new Date(e).getTime(),a=document.querySelectorAll(".task-date");a&&a.forEach((function(e){var a=document.createElement("ul");setInterval((function(){var e=(new Date).getTime(),n=t-e,r=Math.floor(n/864e5),i=Math.floor(n%864e5/36e5),o=Math.floor(n%36e5/6e4),l=Math.floor(n%6e4/1e3);a.innerHTML="\n          <ul>\n            <li><span>".concat(r,"</span>DÃ­as</li>\n            <li><span>").concat(i,"</span>Horas</li>\n            <li><span>").concat(o,"</span>Minutos</li>\n            <li><span>").concat(l,"</span>Segundo</li>\n          </ul>\n        "),n<0&&(a.innerHTML='<p class="finish">TAREA FINALIZADA</p>')}),1);1==e.childNodes.length&&(fragment.appendChild(a),e.appendChild(a))}))},insertData=function(e){var t=document.createElement("div");t.classList.add("task"),t.classList.add("".concat(e.color)),t.innerHTML='\n    <div class="task-title">\n      <h1>'.concat(e.task,'</h1>\n    </div>\n    <div class="task-date">\n    </div>\n  ');var a=document.createElement("input");a.classList.add("btn-delete"),a.setAttribute("type","button"),a.setAttribute("data-key",e.id),a.setAttribute("value","X"),t.appendChild(a),a.addEventListener("click",(function(e){deleteStorage(e.target.dataset.key)})),fragment.appendChild(t),divTask.appendChild(fragment),countDownDate(e.date)},setStorage=function(e,t){localStorage.setItem(e,t)},getStorage=function(e){var t=JSON.parse(localStorage.getItem(e));insertData(t)},getAllStorage=function(){divTask.textContent="";for(var e=0;e<=localStorage.length-1;e++){var t=localStorage.key(e);getStorage(t)}},deleteStorage=function(e){localStorage.removeItem(e),getAllStorage()};document.getElementById("deleteAll").addEventListener("click",(function(){divTask.textContent="",localStorage.clear()})),getAllStorage();var validateEmpty=function(e,t){return""!==e.trim()},validateDate=function(e,t){if(!validateEmpty(e)||!validateEmpty(t))return!1;var a=new Date,n=a.getFullYear(),r=a.getMonth()+1,i=r>10?r:"0"+r,o=a.getDate()>10?a.getDate():"0"+a.getDate(),l=e.split("-")[0],s=e.split("-")[1],c=e.split("-")[2];if(l<n||l==n&&s<i)return!1;if(l==n&&s==i&&c<o)return!1;var d=a.getHours(),u=a.getMinutes(),g=t.split(":")[0],v=t.split(":")[1];return l!=n||s!=i||c!=o||!(g<d||g==d&&v<u)},validationMessage=function(e){cleanMessage();var t=document.createElement("div");t.classList.add("error"),t.innerHTML='\n    <p class="error-message">'.concat(e,"</p>\n  "),fragment.prepend(t),divTask.prepend(fragment)},cleanMessage=function(){document.querySelector(".error")&&document.querySelector(".error").remove()};